<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kimkeyring.mapper.OrderMapper">

    <!-- orders 테이블에 주문 저장 -->
    <insert id="insertOrder"
                 parameterType="com.kimkeyring.entity.Order"
                 useGeneratedKeys="true"
                 keyProperty="orderId"
                 keyColumn="order_id">
        INSERT INTO orders (
            user_id,
            total_price,
            status,
            address,
            address_detail,
            created_at
        ) VALUES (
            #{userId},
            #{totalPrice},
            #{status},
            #{address},
            #{addressDetail},
            NOW()
        )
    </insert>

    <!-- order_items 테이블에 주문 상품 저장 -->
    <insert id="insertOrderItem"
                 parameterType="com.kimkeyring.entity.OrderItem">
        INSERT INTO order_items (
            order_id,
            product_id,
            quantity,
            price
        ) VALUES (
            #{orderId},
            #{productId},
            #{quantity},
            #{price}
        )
    </insert>

</mapper>